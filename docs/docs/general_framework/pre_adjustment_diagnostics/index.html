<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-docs/general_framework/pre_adjustment_diagnostics">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Pre-Adjustment Diagnostics | balance</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://internalfb.com/docs/docs/general_framework/pre_adjustment_diagnostics/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Pre-Adjustment Diagnostics | balance"><meta data-rh="true" name="description" content="Diagnostics for an unadjusted Sample"><meta data-rh="true" property="og:description" content="Diagnostics for an unadjusted Sample"><meta data-rh="true" name="keywords" content="unadjusted sample,diagnostics"><link data-rh="true" rel="icon" href="/img/balance_logo/icon.png"><link data-rh="true" rel="canonical" href="https://internalfb.com/docs/docs/general_framework/pre_adjustment_diagnostics/"><link data-rh="true" rel="alternate" href="https://internalfb.com/docs/docs/general_framework/pre_adjustment_diagnostics/" hreflang="en"><link data-rh="true" rel="alternate" href="https://internalfb.com/docs/docs/general_framework/pre_adjustment_diagnostics/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="balance RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="balance Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.59da32c8.css">
<link rel="preload" href="/assets/js/runtime~main.56392c7d.js" as="script">
<link rel="preload" href="/assets/js/main.793c6e20.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/balance_logo/icon.svg" alt="balance Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/balance_logo/icon.svg" alt="balance Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">balance</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog/">Blog</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/docs/overview/">Docs</a><a class="navbar__item navbar__link" href="/docs/tutorials/">Tutorials</a><a class="navbar__item navbar__link" href="/docs/api_reference/">API Reference</a><a href="https://github.com/facebookresearch/balance" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/docs/overview/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/docs/general_framework/">General Framework</a><button aria-label="Toggle the collapsible sidebar category &#x27;General Framework&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/docs/general_framework/pre_adjustment_diagnostics/">Pre-Adjustment Diagnostics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/general_framework/adjusting_sample_to_population/">Adjusting Sample to Population</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/general_framework/evaluation_of_results/">Evaluating and using the adjustment weights</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/docs/statistical_methods/">Statistical Methods</a><button aria-label="Toggle the collapsible sidebar category &#x27;Statistical Methods&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/docs/contributing/">Contributing</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/docs/general_framework/"><span itemprop="name">General Framework</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Pre-Adjustment Diagnostics</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Pre-Adjustment Diagnostics</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="covariate-balance">Covariate balance<a class="hash-link" href="#covariate-balance" title="Direct link to heading">â€‹</a></h2><p>A way to check if adjustments are needed is looking at covariate balance by comparing the distribution of covariates in our sample (the respondents before any adjustment), to the distribution of covariates of the population. The same methods will be later used to evaluate the quality of the adjustment in <a href="/docs/docs/general_framework/evaluation_of_results/">evaluating the results</a>.</p><p>There are various methods for comparing covariate balance, either via summary statistics, or through visualizations. The visualizations are implemented either via <a href="https://plotly.com/python/" target="_blank" rel="noopener noreferrer">plotly</a> (offering an interactive interface) or <a href="https://seaborn.pydata.org/" target="_blank" rel="noopener noreferrer">seaborn</a> (leading to a static image).</p><p>The methods implemented in balance include:</p><ol><li>Summary statistics<ol><li>Means</li><li>ASMD (Absolute Standardized Mean Difference)</li></ol></li><li>Visualizations<ol><li>Numerical variables<ol><li>QQ-plots (interactive)</li><li>Kernel density estimation (static)</li><li>Empirical Cumulative Distribution Function (static)</li><li>Histogram (static)</li></ol></li><li>Categorical variables<ol><li>Barplots (interactive or static)</li><li>Probability scatter plot (static)</li></ol></li></ol></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary-statistics">Summary statistics<a class="hash-link" href="#summary-statistics" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="means-and-asmd-absolute-standardized-mean-difference">Means and ASMD (Absolute Standardized Mean Difference)<a class="hash-link" href="#means-and-asmd-absolute-standardized-mean-difference" title="Direct link to heading">â€‹</a></h3><p>The mean of the covariates in the sample versus the target is a basic measure to evaluate the distance of the sample from the target population of interest.</p><p>For categorical variables the means are calculated to each of the <a href="https://en.wikipedia.org/wiki/One-hot" target="_blank" rel="noopener noreferrer">one-hot encoding</a> of the categories of the variable. This is basically the proportion of observations in that bucket.</p><p>It can be calculated simply by running:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sample_with_target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">covars</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>An example of the output:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source                    self     target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_is_na_gender[T.True]  0.08800   0.089800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">age_group[T.25-34]     0.30900   0.297400</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">age_group[T.35-44]     0.17200   0.299200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">age_group[T.45+]       0.04600   0.206300</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gender[Female]         0.26800   0.455100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gender[Male]           0.64400   0.455100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gender[_NA]            0.08800   0.089800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">income                 5.99102  12.737608</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>(TODO: the one hot encoding acts a bit differently for different variables - this will be resolved in future releases)</p><p>The limitation of the mean is that it is not easily comparable between different variables since they may have different variances. The simplest attempt in addressing this issue is using the ASMD.</p><p>The ASMD (Absolute Standardized Mean Deviation) measures the difference per covariate between the sample and target. It uses weighted average and std for the calculations (e.g.: to take design weights into account).
This measure is the same as taking the absolute value of <a href="https://en.wikipedia.org/wiki/Effect_size#Cohen&#x27;s_d" target="_blank" rel="noopener noreferrer">Cohen&#x27;s d statistic</a> (also related to <a href="https://en.wikipedia.org/wiki/Strictly_standardized_mean_difference" target="_blank" rel="noopener noreferrer">SSMD</a>), when using the (weighted) standard deviation of the target population. Other options that occur in the literature includes using the standard deviation based on the sample, or some average of the std of the sample and the target. In order to allow this to be compared across different samples and adjustments, we opted to use the std of the target as the default.</p><p>It can be calculated simply by running:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sample_with_target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">covars</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">asmd</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>An example of the output:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source                  self</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">age_group[T.25-34]  0.025375</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">age_group[T.35-44]  0.277771</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">age_group[T.45+]    0.396127</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gender[Female]      0.375699</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gender[Male]        0.379314</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gender[_NA]         0.006296</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">income              0.517721</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mean(asmd)          0.334860</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For categorical variables the ASMD can be calculated as the average of the ASMD applied to each of the <a href="https://en.wikipedia.org/wiki/One-hot" target="_blank" rel="noopener noreferrer">one-hot encoding</a> of the categories of the variable by using the <code>aggregate_by_main_covar</code> argument:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sample_with_target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">covars</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">asmd</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">aggregate_by_main_covar </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The output:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source          self</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">age_group   0.233091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gender      0.253769</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">income      0.517721</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mean(asmd)  0.334860</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>An average ASMD is calculated for all covariates. It is a simple average of the ASMD for each covariate.  Each ASMD value of categorical variable is used once after aggregated the ASMD from all the <a href="https://en.wikipedia.org/wiki/Dummy_variable_(statistics)" target="_blank" rel="noopener noreferrer">dummy variables</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="visualizations">Visualizations<a class="hash-link" href="#visualizations" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="q-q-plot-plotly">Q-Q Plot (plotly)<a class="hash-link" href="#q-q-plot-plotly" title="Direct link to heading">â€‹</a></h3><p>We provide <a href="https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot" target="_blank" rel="noopener noreferrer">Q-Q Plots</a> as a visual to compare two distributions to one another.</p><p>For example, the plot below is a Q-Q plot for the income covariate for the sample against a straight line of the target population:</p><p><img loading="lazy" src="/assets/images/fig_01_qqplot_income_before-c532ea3cc75158415efa53d599bc32a6.png" width="1803" height="450" class="img_ev3q"></p><p>The closer the line is to the 45-degree-line the better (i.e.: the less bias is observed in the sample as compared to the target population).</p><p>To make a QQ-plot for a specific variable, simply use the following method (the default uses QQ plot with the plotly engine):</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sample_with_target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">covars</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">variables </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;income&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="barplots">Barplots<a class="hash-link" href="#barplots" title="Direct link to heading">â€‹</a></h3><p><a href="https://en.wikipedia.org/wiki/Bar_chart" target="_blank" rel="noopener noreferrer">Barplots</a> provides a way to visually compare the sample and target for categorical covariates.</p><p>Here is an example of the plot for age_group and gender before adjustment:</p><p><img loading="lazy" src="/assets/images/fig_02_barplot_age_before-42914780e173b923ab99aa90738ae159.png" width="1803" height="450" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/fig_03_barplot_gender_before-f931f9dcfd435159a8c0e3449e25543b.png" width="1803" height="450" class="img_ev3q"></p><p>To make these plots, simply use the following:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sample_with_target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">covars</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">variables </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;age_group&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;gender&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="plotting-all-varibales">Plotting all varibales<a class="hash-link" href="#plotting-all-varibales" title="Direct link to heading">â€‹</a></h3><p>If you do not specify a variables list in the plot method, all covariates of you sample object will be plotted:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sample_with_target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">covars</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebookresearch/balance/tree/main/website/docs/docs/general_framework/pre_adjustment_diagnostics.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/docs/general_framework/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">General Framework</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/docs/general_framework/adjusting_sample_to_population/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Adjusting Sample to Population</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#covariate-balance" class="table-of-contents__link toc-highlight">Covariate balance</a></li><li><a href="#summary-statistics" class="table-of-contents__link toc-highlight">Summary statistics</a><ul><li><a href="#means-and-asmd-absolute-standardized-mean-difference" class="table-of-contents__link toc-highlight">Means and ASMD (Absolute Standardized Mean Difference)</a></li></ul></li><li><a href="#visualizations" class="table-of-contents__link toc-highlight">Visualizations</a><ul><li><a href="#q-q-plot-plotly" class="table-of-contents__link toc-highlight">Q-Q Plot (plotly)</a></li><li><a href="#barplots" class="table-of-contents__link toc-highlight">Barplots</a></li><li><a href="#plotting-all-varibales" class="table-of-contents__link toc-highlight">Plotting all varibales</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.fb.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.fb.com" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/meta_opensource_logo_negative.svg" alt="Meta Open Source Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/meta_opensource_logo_negative.svg" alt="Meta Open Source Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">
        Copyright Â© 2024 Meta Platforms, Inc. Built with Docusaurus.<br>
        Documentation Content Licensed Under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY-4.0</a>.<br></div></div></div></footer></div>
<script src="/assets/js/runtime~main.56392c7d.js"></script>
<script src="/assets/js/main.793c6e20.js"></script>
</body>
</html>