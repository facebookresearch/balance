<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>balance.sample_class &#8212; balance  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=29da98fa" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="balance.stats_and_plots" href="balance.stats_and_plots.html" />
    <link rel="prev" title="balance.cli" href="balance.cli.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="balance.stats_and_plots.html" title="balance.stats_and_plots"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="balance.cli.html" title="balance.cli"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">balance  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="balance.html" accesskey="U">balance</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">balance.sample_class</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-balance.sample_class">
<span id="balance-sample-class"></span><h1>balance.sample_class<a class="headerlink" href="#module-balance.sample_class" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="balance.sample_class.Sample">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">balance.sample_class.</span></span><span class="sig-name descname"><span class="pre">Sample</span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample" title="Link to this definition">¶</a></dt>
<dd><p>A class used to represent a sample.</p>
<p>Sample is the main object of balance. It contains a dataframe of unit’s observations,
associated with id and weight.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="balance.sample_class.Sample.id_column">
<span class="sig-name descname"><span class="pre">id_column</span></span><a class="headerlink" href="#balance.sample_class.Sample.id_column" title="Link to this definition">¶</a></dt>
<dd><p>a column representing the ids of the units in sample</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="balance.sample_class.Sample.weight_column">
<span class="sig-name descname"><span class="pre">weight_column</span></span><a class="headerlink" href="#balance.sample_class.Sample.weight_column" title="Link to this definition">¶</a></dt>
<dd><p>a column representing the weights of the units in sample</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.adjust">
<span class="sig-name descname"><span class="pre">adjust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'Sample'</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'cbps'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'ipw'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'null'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'poststratify'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'rake'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ipw'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><span class="pre">Sample</span></a></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.adjust"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.adjust" title="Link to this definition">¶</a></dt>
<dd><p>Perform adjustment of one sample to match another.
This function returns a new sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>&quot;Sample&quot;</em><em> | </em><em>None</em>) – Second sample object which should be matched.
If None, the set target of the object is used for matching.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – method for adjustment: cbps, ipw, null, poststratify, rake</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an adjusted Sample object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample">Sample</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>During adjustment, the method automatically detects and warns about high-cardinality
categorical features (features where most values are unique). These features
typically don’t provide meaningful signal for adjustment and may lead to
unstable or uniform weights. The warning helps identify features that should be
reviewed or excluded from the adjustment.</p>
</div>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import balance
from sklearn.ensemble import HistGradientBoostingClassifier
from balance import Sample
from balance import load_data</p>
<p># Load simulated data
target_df, sample_df = load_data()</p>
<p>sample</p>
<p>sample = Sample.from_frame(sample_df, outcome_columns=[“happiness”])
# Often times we don’t have the outcome for the target. In this case we’ve added it just to validate later that the weights indeed help us reduce the bias
target = Sample.from_frame(target_df, outcome_columns=[“happiness”])</p>
<p>sample_with_target = sample.set_target(target)
adjusted = sample_with_target.adjust()</p>
<dl class="simple">
<dt>hgb = HistGradientBoostingClassifier(</dt><dd><p>random_state=0, categorical_features=”from_dtype”</p>
</dd>
</dl>
<p>)
adjusted_hgb = sample_with_target.adjust(</p>
<blockquote>
<div><p>model=hgb,
use_model_matrix=False,</p>
</div></blockquote>
<p>)</p>
<p># Print ASMD tables for both adjusted and adjusted_hgb
print(”n=== Adjusted ASMD ===”)
print(adjusted.covars().asmd().T)</p>
<p>print(”n=== Adjusted_HGB ASMD ===”)
print(adjusted_hgb.covars().asmd().T)</p>
<p># output (values will vary by model and random seed)
#
# === Adjusted ASMD ===
# source                  self  unadjusted  unadjusted - self
# age_group[T.25-34]  0.021777    0.005688          -0.016090
# age_group[T.35-44]  0.055884    0.312711           0.256827
# age_group[T.45+]    0.169816    0.378828           0.209013
# gender[Female]      0.097916    0.375699           0.277783
# gender[Male]        0.103989    0.379314           0.275324
# gender[_NA]         0.010578    0.006296          -0.004282
# income              0.205469    0.494217           0.288748
# mean(asmd)          0.119597    0.326799           0.207202
#
# === Adjusted_HGB ASMD ===
# source                  self  unadjusted  unadjusted - self
# age_group[T.25-34]       …    0.005688            …
# age_group[T.35-44]       …    0.312711            …
# age_group[T.45+]         …    0.378828            …
# gender[Female]           …    0.375699            …
# gender[Male]             …    0.379314            …
# gender[_NA]              …    0.006296            …
# income                   …    0.494217            …
# mean(asmd)               …    0.326799            …</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.covar_means">
<span class="sig-name descname"><span class="pre">covar_means</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.covar_means"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.covar_means" title="Link to this definition">¶</a></dt>
<dd><p>Compare the means of covariates (after using <code class="xref py py-func docutils literal notranslate"><span class="pre">BalanceDF.model_matrix()</span></code>) before and after adjustment as compared with target.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – A Sample object produces after running <a class="reference internal" href="#balance.sample_class.Sample.adjust" title="balance.sample_class.Sample.adjust"><code class="xref py py-func docutils literal notranslate"><span class="pre">Sample.adjust()</span></code></a>.
It should include 3 components: “unadjusted”, “adjusted”, “target”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame with 3 columns (“unadjusted”, “adjusted”, “target”),
and a row for each feature of the covariates.
The cells show the mean value. For categorical features, they are first transformed into the one-hot encoding.
For these columns, since they are all either 0 or 1, their means should be interpreted as proportions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>from balance import Sample
import pandas as pd</p>
<dl>
<dt>s = Sample.from_frame(</dt><dd><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“a”: (0, 1, 2), “c”: (“a”, “b”, “c”), “o”: (1,3,5), “id”: (1, 2, 3)}</p>
</dd>
</dl>
<p>),
outcome_columns=(“o”),</p>
</dd>
</dl>
<p>)
s_adjusted = s.set_target(s).adjust(method = ‘null’)
print(s_adjusted.covar_means())</p>
<blockquote>
<div><p># source  unadjusted  adjusted    target
# a         1.000000  1.000000  1.000000
# c[a]      0.333333  0.333333  0.333333
# c[b]      0.333333  0.333333  0.333333
# c[c]      0.333333  0.333333  0.333333</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.covars">
<span class="sig-name descname"><span class="pre">covars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.covars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.covars" title="Link to this definition">¶</a></dt>
<dd><p>Produce a BalanceDFCovars from a Sample object.
See :class:BalanceDFCovars.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – Sample object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>BalanceDFCovars</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl>
<dt>pd.DataFrame(</dt><dd><dl class="simple">
<dt>{</dt><dd><p>“id”: [“1”, “2”],
“x”: [0, 1],
“weight”: [1.0, 2.0],
“y”: [0.1, 0.2],</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
outcome_columns=”y”,
standardize_types=False,</p>
</div></blockquote>
<p>)
sample.covars().df.columns.tolist()
# [‘x’]</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.design_effect">
<span class="sig-name descname"><span class="pre">design_effect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.design_effect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.design_effect" title="Link to this definition">¶</a></dt>
<dd><p>Return the design effect of the weights of Sample. Uses <code class="xref py py-func docutils literal notranslate"><span class="pre">weights_stats.design_effect()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – A Sample object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Design effect</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.float64</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“1”, “2”], “x”: [0, 1], “weight”: [1.0, 2.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
round(sample.design_effect(), 3)
# 1.111</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.design_effect_prop">
<span class="sig-name descname"><span class="pre">design_effect_prop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.design_effect_prop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.design_effect_prop" title="Link to this definition">¶</a></dt>
<dd><p>Return the relative difference in design effect of the weights of the unadjusted sample and the adjusted sample.
I.e. (Deff of adjusted - Deff of unadjusted) / Deff of unadjusted.
Uses <code class="xref py py-func docutils literal notranslate"><span class="pre">weights_stats.design_effect()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – A Sample object produces after running <a class="reference internal" href="#balance.sample_class.Sample.adjust" title="balance.sample_class.Sample.adjust"><code class="xref py py-func docutils literal notranslate"><span class="pre">Sample.adjust()</span></code></a>.
It should include 3 components: “unadjusted”, “adjusted”, “target”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>relative difference in design effect.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.float64</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl>
<dt>pd.DataFrame(</dt><dd><dl class="simple">
<dt>{</dt><dd><p>“id”: [“1”, “2”],
“x”: [0, 1],
“weight”: [1.0, 2.0],
“y”: [0.1, 0.2],</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
outcome_columns=”y”,
standardize_types=False,</p>
</div></blockquote>
<p>)
target = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“3”, “4”], “x”: [0, 1], “weight”: [1.0, 1.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
adjusted = sample.set_target(target).adjust(method=”null”)
_ = adjusted.design_effect_prop()</p>
</div></blockquote>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="balance.sample_class.Sample.df">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">df</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></span><a class="headerlink" href="#balance.sample_class.Sample.df" title="Link to this definition">¶</a></dt>
<dd><p>Produce a DataFrame (of the self) from a Sample object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – Sample object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>with id_columns, and the df values of covars(), outcome() and weights() of the self in the Sample object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
df = pd.DataFrame(</p>
<blockquote>
<div><dl class="simple">
<dt>{</dt><dd><p>“id”: [“1”, “2”],
“x”: [0, 1],
“weight”: [1.0, 2.0],
“y”: [0.1, 0.2],</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>)
sample = Sample.from_frame(</p>
<blockquote>
<div><p>df,
id_column=”id”,
weight_column=”weight”,
outcome_columns=”y”,
standardize_types=False,</p>
</div></blockquote>
<p>)
sample.df.columns.tolist()
# [‘id’, ‘x’, ‘y’, ‘weight’]</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.diagnostics">
<span class="sig-name descname"><span class="pre">diagnostics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights_impact_on_outcome_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'t_test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_impact_on_outcome_conf_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.diagnostics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.diagnostics" title="Link to this definition">¶</a></dt>
<dd><p>Output a table of diagnostics about adjusted Sample object.</p>
<section id="size">
<h2>size<a class="headerlink" href="#size" title="Link to this heading">¶</a></h2>
<p>All values in the “size” metrics are AFTER any rows/columns were filtered.
So, for example, if we use respondents from previous days but filter them for diagnostics purposes, then
sample_obs and target_obs will NOT include them in the counting. The same is true for sample_covars and target_covars.
In the “size” metrics we have the following ‘var’s:
- sample_obs - number of respondents
- sample_covars -  number of covariates (main covars, before any transformations were used)
- target_obs - number of users used to represent the target pop
- target_covars - like sample_covars, but for target.</p>
</section>
<section id="weights-diagnostics">
<h2>weights_diagnostics<a class="headerlink" href="#weights-diagnostics" title="Link to this heading">¶</a></h2>
<p>In the “weights_diagnostics” metric we have the following ‘var’s:
- design effect (de), effective sample size (n/de), effective sample ratio (1/de). See also:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Design_effect">https://en.wikipedia.org/wiki/Design_effect</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Effective_sample_size">https://en.wikipedia.org/wiki/Effective_sample_size</a></p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>sum</p></li>
<li><p>describe of the (normalized to sample size) weights (mean, median, std, etc.)</p></li>
<li><p>prop of the (normalized to sample size) weights that are below or above some numbers (1/2, 1, 2, etc.)</p></li>
<li><p>nonparametric_skew and weighted_median_breakdown_point</p></li>
</ul>
<section id="why-is-the-diagnostics-focused-on-weights-normalized-to-sample-size">
<h3>Why is the diagnostics focused on weights normalized to sample size<a class="headerlink" href="#why-is-the-diagnostics-focused-on-weights-normalized-to-sample-size" title="Link to this heading">¶</a></h3>
<p>There are 3 well known normalizations of weights:
1. to sum to 1
2. to sum to target population
3. to sum to n (sample size)</p>
<p>Each one has their own merits:
1. is good if wanting to easily calculate avg of some response var (then we just use sum(w*y) and no need for /sum(w))
2. is good for sum of stuff. For example, how many people in the US use android? For this we’d like the weight of</p>
<blockquote>
<div><p>each person to represent their share of the population and then we just sum the weights of the people who use android in the survey.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><dl class="simple">
<dt>is good for understanding relative “importance” of a respondent as compared to the weights of others in the survey.</dt><dd><p>So if someone has a weight that is &gt;1 it means that this respondent (conditional on their covariates) was ‘rare’ in the survey,
so the model we used decided to give them a larger weight to account for all the people like him/her that didn’t answer.</p>
</dd>
</dl>
</li>
</ol>
<p>For diagnostics purposes, option 3 is most useful for discussing the distribution of the weights
(e.g.: how many respondents got a weight &gt;2 or smaller &lt;0.5).
This is a method (standardized  across surveys) to helping us identify how many of the respondents are “dominating”
and have a large influence on the conclusion we draw from the survey.</p>
</section>
</section>
<section id="model-glance">
<h2>model_glance<a class="headerlink" href="#model-glance" title="Link to this heading">¶</a></h2>
<p>Properties of the model fitted, depends on the model used for weighting.</p>
</section>
<section id="covariates-asmd">
<h2>covariates ASMD<a class="headerlink" href="#covariates-asmd" title="Link to this heading">¶</a></h2>
<p>Includes covariates ASMD before and after adjustment (per level of covariate and aggregated) and the ASMD improvement.</p>
<dl class="field-list simple">
<dt class="field-odd">param self<span class="colon">:</span></dt>
<dd class="field-odd"><p>only after running an adjustment with Sample.adjust.</p>
</dd>
<dt class="field-even">type self<span class="colon">:</span></dt>
<dd class="field-even"><p>Sample</p>
</dd>
<dt class="field-odd">param weights_impact_on_outcome_method<span class="colon">:</span></dt>
<dd class="field-odd"><p>If provided, include
outcome-weight impact diagnostics using the specified method.
Defaults to “t_test”.</p>
</dd>
<dt class="field-even">type weights_impact_on_outcome_method<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional[str]</p>
</dd>
<dt class="field-odd">param weights_impact_on_outcome_conf_level<span class="colon">:</span></dt>
<dd class="field-odd"><p>Confidence level for
the outcome impact interval. Defaults to 0.95.</p>
</dd>
<dt class="field-even">type weights_impact_on_outcome_conf_level<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>with 3 columns: (“metric”, “val”, “var”),</dt><dd><p>indicating various tracking metrics on the model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“1”, “2”], “x”: [0, 1], “weight”: [1.0, 2.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
target = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“3”, “4”], “x”: [0, 1], “weight”: [1.0, 1.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
adjusted = sample.set_target(target).adjust(method=”null”)
adjusted.diagnostics().columns.tolist()
# [‘metric’, ‘val’, ‘var’]</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.from_frame">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_id_uniqueness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardize_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_deepcopy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_column_candidates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><span class="pre">Sample</span></a></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.from_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.from_frame" title="Link to this definition">¶</a></dt>
<dd><p>Create a new Sample object.</p>
<p>NOTE that all integer columns will be converted by defaults into floats. This behavior can be turned off
by setting standardize_types argument to False.
The reason this is done by default is because of missing value handling combined with balance current lack of support
for pandas Integer types:</p>
<blockquote>
<div><p>1. Native numpy integers do not support missing values (NA), while pandas Integers do,
as well numpy floats. Also,
2. various functions in balance do not support pandas Integers, while they do support numpy floats.
3. Hence, since some columns might have missing values, the safest solution is to just convert all integers into numpy floats.</p>
</div></blockquote>
<p>The id_column is stored as a string, even if the input is an integer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – containing the sample’s data</p></li>
<li><p><strong>id_column</strong> (<em>str</em><em> | </em><em>None</em>) – the column of the df which contains the respondent’s id</p></li>
<li><p><strong>None.</strong> (<em>(</em><em>should be unique</em><em>)</em><em>. Defaults to</em>)</p></li>
<li><p><strong>outcome_columns</strong> (<em>list</em><em> | </em><em>tuple</em><em> | </em><em>str</em><em> | </em><em>None</em>) – names of columns to treat as outcome</p></li>
<li><p><strong>weight_column</strong> (<em>str</em><em> | </em><em>None</em>) – name of column to treat as weight. If not specified, will
be guessed (either “weight” or “weights”). If not found, a new column will be created (“weight”) and filled with 1.0.</p></li>
<li><p><strong>ignore_columns</strong> (<em>list</em><em> | </em><em>tuple</em><em> | </em><em>str</em><em> | </em><em>None</em>) – names of columns to keep on the
underlying dataframe but ignore in covariate/outcome handling. These columns
are excluded from outcome statistics and covariate selections. Defaults to None.</p></li>
<li><p><strong>check_id_uniqueness</strong> (<em>bool</em>) – Whether to check if ids are unique. Defaults to True.</p></li>
<li><p><strong>standardize_types</strong> (<em>bool</em>) – Whether to standardize types. Defaults to True.
Int64/int64 -&gt; float64
Int32/int32 -&gt; float64
string -&gt; object
pandas.NA -&gt; numpy.nan (within each cell)
This is slightly memory intensive (since it copies the data twice),
but helps keep various functions working for both Int64 and Int32 input columns.</p></li>
<li><p><strong>use_deepcopy</strong> (<em>Optional</em><em>, </em><em>bool</em>) – Whether to have a new df copy inside the sample object.
If False, then when the sample methods update the internal df then the original df will also be updated.
Defaults to True.</p></li>
<li><p><strong>id_column_candidates</strong> (<em>list</em><em> | </em><em>tuple</em><em> | </em><em>str</em><em> | </em><em>None</em>) – candidate id column names
to use when id_column is not provided. Defaults to None which uses
[“id”].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a sample object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample">Sample</a></p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
df = pd.DataFrame(</p>
<blockquote>
<div><dl class="simple">
<dt>{</dt><dd><p>“id”: [“1”, “2”],
“x”: [0, 1],
“weight”: [1.0, 2.0],
“y”: [0.1, 0.2],</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>)
sample = Sample.from_frame(</p>
<blockquote>
<div><p>df,
id_column=”id”,
weight_column=”weight”,
outcome_columns=”y”,
standardize_types=False,</p>
</div></blockquote>
<p>)
isinstance(sample, Sample)
# True</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.has_target">
<span class="sig-name descname"><span class="pre">has_target</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.has_target"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.has_target" title="Link to this definition">¶</a></dt>
<dd><p>Check if a Sample object has target attached.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>whether the Sample has target attached</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“1”, “2”], “x”: [0, 1], “weight”: [1.0, 2.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
target = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“3”, “4”], “x”: [0, 1], “weight”: [1.0, 1.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
sample.set_target(target).has_target()
# True</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.ignored_columns">
<span class="sig-name descname"><span class="pre">ignored_columns</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.ignored_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.ignored_columns" title="Link to this definition">¶</a></dt>
<dd><p>Return columns marked as ignored on the sample.</p>
<p>These columns stay on the underlying dataframe for tracking purposes
but are excluded from covariate selection and outcome statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame of ignored columns, or None when
no ignored columns are defined.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional[pd.DataFrame]</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
df = pd.DataFrame(</p>
<blockquote>
<div><p>{“id”: [1, 2], “note”: [“x”, “y”], “age”: [20, 21], “out”: [0, 1]}</p>
</div></blockquote>
<p>)
sample = Sample.from_frame(</p>
<blockquote>
<div><p>df, id_column=”id”, outcome_columns=”out”, ignore_columns=[“note”], weight_column=None</p>
</div></blockquote>
<p>)
sample.ignored_columns().columns.tolist()
# [‘note’]</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.is_adjusted">
<span class="sig-name descname"><span class="pre">is_adjusted</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.is_adjusted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.is_adjusted" title="Link to this definition">¶</a></dt>
<dd><p>Check if a Sample object is adjusted and has target attached</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>whether the Sample is adjusted or not.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“1”, “2”], “x”: [0, 1], “weight”: [1.0, 2.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
sample.is_adjusted()
# False</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.keep_only_some_rows_columns">
<span class="sig-name descname"><span class="pre">keep_only_some_rows_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rows_to_keep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns_to_keep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><span class="pre">Sample</span></a></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.keep_only_some_rows_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.keep_only_some_rows_columns" title="Link to this definition">¶</a></dt>
<dd><p>This function returns the sample object after filtering rows and/or columns from _df and _links objects
(which includes unadjusted and target objects).</p>
<p>This function is useful when wanting to calculate metrics, such as ASMD, but only on some of the features,
or part of the observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – a sample object (preferably after adjustment)</p></li>
<li><p><strong>rows_to_keep</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – A string with a condition to eval (on some of the columns).
This will run df.eval(rows_to_keep) which will return a pd.Series of bool by which
we will filter the Sample object.
This effects both the df of covars AND the weights column (weight_column)
AND the outcome column (_outcome_columns), AND the id_column column.
Input should be a boolean feature, or a condition such as: ‘gender == “Female” &amp; age &gt;= 18’.
Defaults to None.</p></li>
<li><p><strong>columns_to_keep</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – the covariates of interest.
Defaults to None, which returns all columns.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>If both rows and columns to keep are None, returns the original object unchanged.</dt><dd><p>Otherwise, returns a copy of the original object with filtering applied - first the rows, then the columns.
This performs the transformation on both the sample’s df and its linked dfs (unadjusted, target).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample">Sample</a></p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl>
<dt>pd.DataFrame(</dt><dd><dl class="simple">
<dt>{</dt><dd><p>“id”: [“1”, “2”],
“x”: [0, 1],
“weight”: [1.0, 2.0],
“y”: [0.1, 0.2],</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
outcome_columns=”y”,
standardize_types=False,</p>
</div></blockquote>
<p>)
sample.keep_only_some_rows_columns(rows_to_keep=”x == 1”).df.shape
# (1, 4)</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.model">
<span class="sig-name descname"><span class="pre">model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.model" title="Link to this definition">¶</a></dt>
<dd><p>Returns the adjustment model dictionary if Sample has been adjusted.
Otherwise returns None.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">_adjustment_model</span></code> attribute is initialized as <code class="docutils literal notranslate"><span class="pre">None</span></code> at the class
level and is set to a dictionary containing model details when
<a class="reference internal" href="#balance.sample_class.Sample.adjust" title="balance.sample_class.Sample.adjust"><code class="xref py py-meth docutils literal notranslate"><span class="pre">adjust()</span></code></a> is called. This method simply returns that attribute,
which will be <code class="docutils literal notranslate"><span class="pre">None</span></code> for unadjusted samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – Sample object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Dictionary containing adjustment model details</dt><dd><p>(e.g., method name, fitted model, performance metrics) if the sample
has been adjusted, otherwise None.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any] or None</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“1”, “2”], “x”: [0, 1], “weight”: [1.0, 2.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
sample.model() is None
# True</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.model_matrix">
<span class="sig-name descname"><span class="pre">model_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.model_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.model_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Returns the model matrix of sample using <a class="reference internal" href="#balance.sample_class.Sample.model_matrix" title="balance.sample_class.Sample.model_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">model_matrix()</span></code></a>,
while adding na indicator for null values (see <code class="xref py py-func docutils literal notranslate"><span class="pre">add_na_indicator()</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>model matrix of sample</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“1”, “2”], “x”: [0, 1], “weight”: [1.0, 2.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
sample.model_matrix().shape
# (2, 1)</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.outcome_sd_prop">
<span class="sig-name descname"><span class="pre">outcome_sd_prop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.outcome_sd_prop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.outcome_sd_prop" title="Link to this definition">¶</a></dt>
<dd><p>Return the difference in outcome weighted standard deviation (sd) of the unadjusted
sample and the adjusted sample, relative to the unadjusted weighted sd.
I.e. (weighted sd of adjusted - weighted sd of unadjusted) / weighted sd  of unadjusted.
Uses <code class="xref py py-func docutils literal notranslate"><span class="pre">BalanceDF.weighted_stats.weighted_sd()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – A Sample object produces after running <a class="reference internal" href="#balance.sample_class.Sample.adjust" title="balance.sample_class.Sample.adjust"><code class="xref py py-func docutils literal notranslate"><span class="pre">Sample.adjust()</span></code></a>.
It should include 3 components: “unadjusted”, “adjusted”, “target”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(np.float64) relative difference in outcome weighted standard deviation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl>
<dt>pd.DataFrame(</dt><dd><dl class="simple">
<dt>{</dt><dd><p>“id”: [“1”, “2”],
“x”: [0, 1],
“weight”: [1.0, 2.0],
“y”: [0.1, 0.2],</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
outcome_columns=”y”,
standardize_types=False,</p>
</div></blockquote>
<p>)
target = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“3”, “4”], “x”: [0, 1], “weight”: [1.0, 1.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
adjusted = sample.set_target(target).adjust(method=”null”)
_ = adjusted.outcome_sd_prop()</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.outcome_variance_ratio">
<span class="sig-name descname"><span class="pre">outcome_variance_ratio</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.outcome_variance_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.outcome_variance_ratio" title="Link to this definition">¶</a></dt>
<dd><p>The empirical ratio of variance of the outcomes before and after weighting.</p>
<p>See <a class="reference internal" href="#balance.sample_class.Sample.outcome_variance_ratio" title="balance.sample_class.Sample.outcome_variance_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">outcome_variance_ratio()</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – A Sample object produces after running <a class="reference internal" href="#balance.sample_class.Sample.adjust" title="balance.sample_class.Sample.adjust"><code class="xref py py-func docutils literal notranslate"><span class="pre">Sample.adjust()</span></code></a>.
It should include 3 components: “unadjusted”, “adjusted”, “target”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(np.float64) A series of calculated ratio of variances for each outcome.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl>
<dt>pd.DataFrame(</dt><dd><dl class="simple">
<dt>{</dt><dd><p>“id”: [“1”, “2”],
“x”: [0, 1],
“weight”: [1.0, 2.0],
“y”: [0.1, 0.2],</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
outcome_columns=”y”,
standardize_types=False,</p>
</div></blockquote>
<p>)
target = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“3”, “4”], “x”: [0, 1], “weight”: [1.0, 1.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
adjusted = sample.set_target(target).adjust(method=”null”)
_ = adjusted.outcome_variance_ratio()</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.outcomes">
<span class="sig-name descname"><span class="pre">outcomes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.outcomes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.outcomes" title="Link to this definition">¶</a></dt>
<dd><p>Produce a BalanceOutcomeDF from a Sample object.
See :class:BalanceDFOutcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – Sample object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>BalanceDFOutcomes or None</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl>
<dt>pd.DataFrame(</dt><dd><dl class="simple">
<dt>{</dt><dd><p>“id”: [“1”, “2”],
“x”: [0, 1],
“weight”: [1.0, 2.0],
“y”: [0.1, 0.2],</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
outcome_columns=”y”,
standardize_types=False,</p>
</div></blockquote>
<p>)
sample.outcomes().df.columns.tolist()
# [‘y’]</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.plot_weight_density">
<span class="sig-name descname"><span class="pre">plot_weight_density</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.plot_weight_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.plot_weight_density" title="Link to this definition">¶</a></dt>
<dd><p>Plot the density of weights of Sample.</p>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import numpy as np
import pandas as pd
from balance.sample_class import Sample</p>
<p>np.random.seed(123)
df = pd.DataFrame(</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“a”: np.random.uniform(size=100),
“c”: np.random.choice(</p>
<blockquote>
<div><p>[“a”, “b”, “c”, “d”],
size=100,
replace=True,
p=[0.01, 0.04, 0.5, 0.45],</p>
</div></blockquote>
<p>),
“id”: range(100),
“weight”: np.random.uniform(size=100) + 0.5,</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>)</p>
<p>a = Sample.from_frame(df)
sample.weights().plot()
# The same as:
sample.plot_weight_density()</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.set_target">
<span class="sig-name descname"><span class="pre">set_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><span class="pre">Sample</span></a></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.set_target"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.set_target" title="Link to this definition">¶</a></dt>
<dd><p>Used to set the target linked to Sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>target</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – A Sample object to be linked as target</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new copy of Sample with target link attached</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample">Sample</a></p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“1”, “2”], “x”: [0, 1], “weight”: [1.0, 2.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
target = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“3”, “4”], “x”: [0, 1], “weight”: [1.0, 1.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
sample.set_target(target).has_target()
# True</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.set_unadjusted">
<span class="sig-name descname"><span class="pre">set_unadjusted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">second_sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><span class="pre">Sample</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><span class="pre">Sample</span></a></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.set_unadjusted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.set_unadjusted" title="Link to this definition">¶</a></dt>
<dd><p>Used to set the unadjusted link to Sample.
This is useful in case one wants to compare two samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>second_sample</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – A second Sample to be set as unadjusted of Sample.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a new copy of Sample with unadjusted link attached to the self object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample">Sample</a></p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“1”, “2”], “x”: [0, 1], “weight”: [1.0, 2.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
linked = sample.set_unadjusted(sample)
linked.is_adjusted()
# False</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.set_weights">
<span class="sig-name descname"><span class="pre">set_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.set_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.set_weights" title="Link to this definition">¶</a></dt>
<dd><p>Adjusting the weights of a Sample object.
This will overwrite the weight_column of the Sample.
Note that the weights are assigned by index if weights is a pd.Series
(of Sample.df and weights series)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>weights</strong> (<em>pd.Series</em><em> | </em><em>float</em><em> | </em><em>None</em>) – Series of weights to add to sample.
If None or float values, the same weight (or None) will be assigned to all units.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None, but adapting the Sample weight column to weights</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“1”, “2”], “x”: [0, 1], “weight”: [1.0, 2.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
sample.set_weights(pd.Series([1.0, 3.0], index=sample.df.index))
sample.weights().df[“weight”].tolist()
# [1.0, 3.0]</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.summary" title="Link to this definition">¶</a></dt>
<dd><p>Provides a summary of covariate balance, design effect and model properties (if applicable)
of a sample.</p>
<p>The summary consolidates high-level diagnostics that are most helpful after adjustment,
including covariate balance, weight health, outcome behavior, and basic model fit when
available.</p>
<p>For more details see: <code class="xref py py-func docutils literal notranslate"><span class="pre">BalanceDF.asmd()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">BalanceDF.asmd_improvement()</span></code>
and <code class="xref py py-func docutils literal notranslate"><span class="pre">weights_stats.design_effect()</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a summary description of properties of an adjusted sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
survey = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“x”: (0, 1, 1, 0), “id”: range(4), “y”: (0.1, 0.5, 0.4, 0.9), “w”: (1, 2, 1, 1)}</p>
</dd>
</dl>
<p>),
id_column=”id”,
outcome_columns=”y”,
weight_column=”w”,</p>
</div></blockquote>
<p>)
target = Sample.from_frame(</p>
<blockquote>
<div><p>pd.DataFrame({“x”: (0, 0, 1, 1), “id”: range(4)}),
id_column=”id”,</p>
</div></blockquote>
<p>)
adjusted = survey.set_target(target).adjust(method=”null”)
print(adjusted.summary())
Adjustment details:</p>
<blockquote>
<div><p>method: null_adjustment</p>
</div></blockquote>
<dl class="simple">
<dt>Covariate diagnostics:</dt><dd><p>Covar ASMD reduction: 0.0%
Covar ASMD (1 variables): 0.173 -&gt; 0.173
Covar mean KLD reduction: 0.0%
Covar mean KLD (1 variables): 0.020 -&gt; 0.020</p>
</dd>
<dt>Weight diagnostics:</dt><dd><p>design effect (Deff): 1.120
effective sample size proportion (ESSP): 0.893
effective sample size (ESS): 3.6</p>
</dd>
<dt>Outcome weighted means:</dt><dd><p>y</p>
</dd>
</dl>
<p>source
self       0.480
unadjusted 0.480</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.to_csv">
<span class="sig-name descname"><span class="pre">to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_or_buf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IO</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.to_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.to_csv" title="Link to this definition">¶</a></dt>
<dd><p>Write df with ids from BalanceDF to a comma-separated values (csv) file.</p>
<p>Uses <code class="xref py py-func docutils literal notranslate"><span class="pre">pd.DataFrame.to_csv()</span></code>.</p>
<p>If an ‘index’ argument is not provided then it defaults to False.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – Object.</p></li>
<li><p><strong>path_or_buf</strong> (<em>FilePathOrBuffer</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – location where to save the csv.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If path_or_buf is None, returns the resulting csv format as a string. Otherwise returns None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“1”, “2”], “x”: [0, 1], “weight”: [1.0, 2.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
csv_text = sample.to_csv()
“id” in csv_text
# True</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.to_download">
<span class="sig-name descname"><span class="pre">to_download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tempdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">FileLink</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.to_download"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.to_download" title="Link to this definition">¶</a></dt>
<dd><p>Creates a downloadable link of the DataFrame of the Sample object.</p>
<p>File name starts with <a href="#id1"><span class="problematic" id="id2">tmp_balance_out_</span></a>, and some random file name (using <code class="xref py py-func docutils literal notranslate"><span class="pre">uuid.uuid4()</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – Object.</p></li>
<li><p><strong>tempdir</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Defaults to None (which then uses a temporary folder using <code class="xref py py-func docutils literal notranslate"><span class="pre">tempfile.gettempdir()</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Embedding a local file link in an IPython session, based on path. Using :func:FileLink.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>FileLink</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
import tempfile
from IPython.lib.display import FileLink
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame(</dt><dd><p>{“id”: [“1”, “2”], “x”: [0, 1], “weight”: [1.0, 2.0]}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
standardize_types=False,</p>
</div></blockquote>
<p>)
isinstance(sample.to_download(tempdir=tempfile.gettempdir()), FileLink)
# True</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="balance.sample_class.Sample.weights">
<span class="sig-name descname"><span class="pre">weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/balance/sample_class.html#Sample.weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#balance.sample_class.Sample.weights" title="Link to this definition">¶</a></dt>
<dd><p>Produce a BalanceDFWeights from a Sample object.
See :class:BalanceDFWeights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#balance.sample_class.Sample" title="balance.sample_class.Sample"><em>Sample</em></a>) – Sample object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>BalanceDFWeights</p>
</dd>
</dl>
<p>Examples:
.. code-block:: python</p>
<blockquote>
<div><p>import pandas as pd
from balance.sample_class import Sample
sample = Sample.from_frame(</p>
<blockquote>
<div><dl>
<dt>pd.DataFrame(</dt><dd><dl class="simple">
<dt>{</dt><dd><p>“id”: [“1”, “2”],
“x”: [0, 1],
“weight”: [1.0, 2.0],
“y”: [0.1, 0.2],</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>),
id_column=”id”,
weight_column=”weight”,
outcome_columns=”y”,
standardize_types=False,</p>
</div></blockquote>
<p>)
sample.weights().df.columns.tolist()
# [‘weight’]</p>
</div></blockquote>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">balance.sample_class</a><ul>
<li><a class="reference internal" href="#balance.sample_class.Sample"><code class="docutils literal notranslate"><span class="pre">Sample</span></code></a><ul>
<li><a class="reference internal" href="#balance.sample_class.Sample.id_column"><code class="docutils literal notranslate"><span class="pre">Sample.id_column</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.weight_column"><code class="docutils literal notranslate"><span class="pre">Sample.weight_column</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.adjust"><code class="docutils literal notranslate"><span class="pre">Sample.adjust()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.covar_means"><code class="docutils literal notranslate"><span class="pre">Sample.covar_means()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.covars"><code class="docutils literal notranslate"><span class="pre">Sample.covars()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.design_effect"><code class="docutils literal notranslate"><span class="pre">Sample.design_effect()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.design_effect_prop"><code class="docutils literal notranslate"><span class="pre">Sample.design_effect_prop()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.df"><code class="docutils literal notranslate"><span class="pre">Sample.df</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.diagnostics"><code class="docutils literal notranslate"><span class="pre">Sample.diagnostics()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.from_frame"><code class="docutils literal notranslate"><span class="pre">Sample.from_frame()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.has_target"><code class="docutils literal notranslate"><span class="pre">Sample.has_target()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.ignored_columns"><code class="docutils literal notranslate"><span class="pre">Sample.ignored_columns()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.is_adjusted"><code class="docutils literal notranslate"><span class="pre">Sample.is_adjusted()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.keep_only_some_rows_columns"><code class="docutils literal notranslate"><span class="pre">Sample.keep_only_some_rows_columns()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.model"><code class="docutils literal notranslate"><span class="pre">Sample.model()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.model_matrix"><code class="docutils literal notranslate"><span class="pre">Sample.model_matrix()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.outcome_sd_prop"><code class="docutils literal notranslate"><span class="pre">Sample.outcome_sd_prop()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.outcome_variance_ratio"><code class="docutils literal notranslate"><span class="pre">Sample.outcome_variance_ratio()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.outcomes"><code class="docutils literal notranslate"><span class="pre">Sample.outcomes()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.plot_weight_density"><code class="docutils literal notranslate"><span class="pre">Sample.plot_weight_density()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.set_target"><code class="docutils literal notranslate"><span class="pre">Sample.set_target()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.set_unadjusted"><code class="docutils literal notranslate"><span class="pre">Sample.set_unadjusted()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.set_weights"><code class="docutils literal notranslate"><span class="pre">Sample.set_weights()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.summary"><code class="docutils literal notranslate"><span class="pre">Sample.summary()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.to_csv"><code class="docutils literal notranslate"><span class="pre">Sample.to_csv()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.to_download"><code class="docutils literal notranslate"><span class="pre">Sample.to_download()</span></code></a></li>
<li><a class="reference internal" href="#balance.sample_class.Sample.weights"><code class="docutils literal notranslate"><span class="pre">Sample.weights()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="balance.cli.html"
                          title="previous chapter">balance.cli</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="balance.stats_and_plots.html"
                          title="next chapter">balance.stats_and_plots</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/balance.sample_class.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="balance.stats_and_plots.html" title="balance.stats_and_plots"
             >next</a> |</li>
        <li class="right" >
          <a href="balance.cli.html" title="balance.cli"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">balance  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="balance.html" >balance</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">balance.sample_class</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    </div>
  </body>
</html>